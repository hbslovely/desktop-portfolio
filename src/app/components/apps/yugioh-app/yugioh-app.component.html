<div class="yugioh-app-container">
  <!-- Header -->
  <div class="app-header">
    <div class="header-title">
      <h1>Yu-Gi-Oh! Card Database</h1>
      <p class="subtitle">Powered by YGOPRODeck API</p>
    </div>
    <div class="header-actions">
      <button class="btn-icon" (click)="getRandomCard()" title="Random Card">
        <i class="pi pi-refresh"></i>
      </button>
      <button class="btn-icon" (click)="toggleViewMode()" title="Toggle View">
        <i [class]="viewMode() === 'grid' ? 'pi pi-list' : 'pi pi-th-large'"></i>
      </button>
    </div>
  </div>

  <!-- Statistics Bar -->
  <div class="stats-bar">
    <div class="stat-item">
      <span class="stat-label">Showing:</span>
      <span class="stat-value">{{ displayedCount() }} / {{ totalCards() }}</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Monsters:</span>
      <span class="stat-value">{{ monsterCards() }}</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Spells:</span>
      <span class="stat-value">{{ spellCards() }}</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Traps:</span>
      <span class="stat-value">{{ trapCards() }}</span>
    </div>
  </div>

  <!-- Search and Filters -->
  <div class="filters-section">
    <div class="search-box">
      <i class="pi pi-search"></i>
      <input 
        type="text" 
        [(ngModel)]="searchQuery"
        (ngModelChange)="onSearchChange()"
        placeholder="Search by name or description..."
        class="search-input">
      <button 
        *ngIf="searchQuery()" 
        class="clear-search"
        (click)="searchQuery.set(''); onSearchChange()">
        <i class="pi pi-times"></i>
      </button>
    </div>

    <div class="filter-row">
      <select [(ngModel)]="selectedFrameType" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="">All Frame Types</option>
        <option *ngFor="let frameType of availableFrameTypes()" [value]="frameType">
          {{ frameType }}
        </option>
      </select>

      <select [(ngModel)]="selectedType" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="">All Types</option>
        <option *ngFor="let type of availableTypes()" [value]="type">
          {{ type }}
        </option>
      </select>

      <select [(ngModel)]="selectedRace" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="">All Races</option>
        <option *ngFor="let race of availableRaces()" [value]="race">
          {{ race }}
        </option>
      </select>

      <select [(ngModel)]="selectedAttribute" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="">All Attributes</option>
        <option *ngFor="let attribute of availableAttributes()" [value]="attribute">
          {{ attribute }}
        </option>
      </select>

      <select [(ngModel)]="selectedSort" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="name">Sort by Name</option>
        <option value="atk">Sort by ATK</option>
        <option value="def">Sort by DEF</option>
        <option value="level">Sort by Level</option>
        <option value="type">Sort by Type</option>
      </select>

      <button class="btn-clear-filters" (click)="clearFilters()">
        <i class="pi pi-filter-slash"></i>
        Clear Filters
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-overlay" *ngIf="isLoading()">
    <div class="loading-spinner">
      <i class="pi pi-spin pi-spinner"></i>
    </div>
    <p>Loading Yu-Gi-Oh! cards...</p>
  </div>

  <!-- Cards Content -->
  <div class="cards-content" *ngIf="!isLoading()" (scroll)="onScroll($event)">
    <!-- Grid View -->
    <div class="cards-grid" *ngIf="viewMode() === 'grid'">
      <div 
        *ngFor="let card of displayedCards()" 
        class="card-item"
        [class]="getFrameTypeClass(card.frameType)"
        (click)="openCardDetail(card)">
        <div class="card-image-wrapper">
          <img 
            [src]="getCardImageUrl(card, 'small')" 
            [alt]="card.name"
            class="card-image"
            loading="lazy">
        </div>
        <div class="card-info">
          <h3 class="card-name">{{ card.name }}</h3>
          <div class="card-meta">
            <span class="card-type">{{ card.race }}</span>
            <span class="card-attribute" *ngIf="card.attribute">
              {{ getAttributeIcon(card.attribute) }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- List View -->
    <div class="cards-list" *ngIf="viewMode() === 'list'">
      <div 
        *ngFor="let card of displayedCards()" 
        class="list-item"
        [class]="getFrameTypeClass(card.frameType)"
        (click)="openCardDetail(card)">
        <img 
          [src]="getCardImageUrl(card, 'cropped')" 
          [alt]="card.name"
          class="list-image"
          loading="lazy">
        <div class="list-info">
          <h3 class="list-name">{{ card.name }}</h3>
          <p class="list-type">{{ card.type }} â€¢ {{ card.race }}</p>
          <p class="list-desc">{{ card.desc | slice:0:150 }}{{ card.desc.length > 150 ? '...' : '' }}</p>
          <div class="list-stats" *ngIf="card.atk !== undefined">
            <span>ATK: {{ card.atk }}</span>
            <span *ngIf="card.def !== undefined">DEF: {{ card.def }}</span>
            <span *ngIf="card.level">Level: {{ card.level }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading More Indicator -->
    <div class="loading-more" *ngIf="isLoadingMore()">
      <div class="loading-spinner">
        <i class="pi pi-spin pi-spinner"></i>
      </div>
      <p>Loading more cards...</p>
    </div>

    <!-- Load More Button -->
    <div class="load-more-section" *ngIf="hasMoreCards() && !isLoadingMore()">
      <button class="btn-load-more" (click)="loadMoreCards()">
        <i class="pi pi-angle-down"></i>
        Load More Cards
        <span class="badge">{{ totalCards() - displayedCount() }} remaining</span>
      </button>
    </div>

    <!-- All Loaded Message -->
    <div class="all-loaded" *ngIf="!hasMoreCards() && displayedCount() > 0">
      <i class="pi pi-check-circle"></i>
      <p>All {{ totalCards() }} cards loaded</p>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading() && filteredCards().length === 0">
    <i class="pi pi-search"></i>
    <h3>No cards found</h3>
    <p>Try adjusting your search or filters</p>
    <button class="btn-primary" (click)="clearFilters()">Clear Filters</button>
  </div>
</div>


