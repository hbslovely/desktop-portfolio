<div class="vnstock-container">
  <!-- Header with Title and Controls -->
  <div class="header">
    <div class="header-content">
      <h2>üáªüá≥ VNStock - Th·ªã Tr∆∞·ªùng Ch·ª©ng Kho√°n Vi·ªát Nam</h2>
      <div class="header-controls">
        <button class="btn-refresh" (click)="loadTabData()" [disabled]="loading">
          {{ loading ? '‚è≥' : 'üîÑ' }}
        </button>
        <button 
          class="btn-auto-refresh" 
          [class.active]="autoRefresh"
          (click)="toggleAutoRefresh()"
        >
          {{ autoRefresh ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Main Tab Navigation -->
  <div class="tab-navigation">
    <button 
      *ngFor="let tab of tabs"
      class="tab-btn"
      [class.active]="activeTab === tab.id"
      (click)="switchTab(tab.id)"
    >
      <span class="tab-icon">{{tab.icon}}</span>
      <span class="tab-name">{{tab.name}}</span>
    </button>
  </div>

  <!-- Error Message -->
  <div class="error-message" *ngIf="error">
    ‚ö†Ô∏è {{ error }}
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" *ngIf="loading">
    <div class="spinner"></div>
    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
  </div>

  <!-- TAB 1: Market (Th·ªã tr∆∞·ªùng) - With Sub-navigation -->
  <div class="tab-content" *ngIf="activeTab === 'market' && !loading">
    <!-- Market Sub-Navigation -->
    <div class="market-sub-nav">
      <button 
        *ngFor="let view of marketViews"
        class="market-sub-btn"
        [class.active]="activeMarketView === view.id"
        (click)="switchMarketView(view.id)"
      >
        <span class="sub-icon">{{view.icon}}</span>
        <span class="sub-name">{{view.name}}</span>
      </button>
    </div>

    <!-- Macro Indicators View -->
    <div *ngIf="activeMarketView === 'macro'">
      <div class="info-bar" *ngIf="lastUpdate">
        <span class="info-item">üåê D·ªØ li·ªáu vƒ© m√¥</span>
        <span class="info-item">‚è∞ {{lastUpdate | date:'HH:mm:ss dd/MM/yyyy'}}</span>
        <span class="info-item">üìä {{filteredMacroIndicators.length}} ch·ªâ s·ªë</span>
      </div>

      <div class="macro-grid">
        <div class="macro-card" *ngFor="let indicator of filteredMacroIndicators">
          <div class="macro-header">
            <span class="macro-name">{{indicator.name}}</span>
            <span class="macro-period" *ngIf="indicator.period">{{indicator.period}}</span>
          </div>
          <div class="macro-value">
            {{formatNumber(indicator.value || 0)}} 
            <span class="macro-unit" *ngIf="indicator.unit">{{indicator.unit}}</span>
          </div>
          <div class="macro-change" [class]="getPriceChangeClass(indicator.changePercent || 0)" *ngIf="indicator.changePercent">
            {{formatPercent(indicator.changePercent)}}
          </div>
        </div>
        <div *ngIf="filteredMacroIndicators.length === 0" class="no-results-content">
          <p>üìä Kh√¥ng c√≥ d·ªØ li·ªáu vƒ© m√¥</p>
        </div>
      </div>
    </div>

    <!-- Top Contributors View -->
    <div *ngIf="activeMarketView === 'contributors'">
    <div class="sub-header">
      <div class="index-selector">
        <button 
          *ngFor="let index of indices"
          class="index-btn"
          [class.active]="selectedIndex === index.code"
          (click)="changeIndex(index.code)"
        >
          {{index.name}}
        </button>
      </div>
      <div class="search-box">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="filterStocks()"
          placeholder="T√¨m ki·∫øm m√£ CP..."
          class="search-input"
        />
      </div>
    </div>

    <div class="info-bar" *ngIf="lastUpdate">
      <span class="info-item">üìä Ch·ªâ s·ªë: <strong>{{getSelectedIndexName()}}</strong></span>
      <span class="info-item">‚è∞ {{lastUpdate | date:'HH:mm:ss dd/MM/yyyy'}}</span>
      <span class="info-item">üìà {{filteredStocks.length}} / {{stocks.length}} c·ªï phi·∫øu</span>
    </div>

    <div class="table-container">
      <table class="stock-table">
        <thead>
          <tr>
            <th (click)="sortBy('symbol')" class="sortable">M√£ CP {{getSortIcon('symbol')}}</th>
            <th (click)="sortBy('name')" class="sortable">T√™n c√¥ng ty {{getSortIcon('name')}}</th>
            <th (click)="sortBy('price')" class="sortable text-right">Gi√° {{getSortIcon('price')}}</th>
            <th (click)="sortBy('change')" class="sortable text-right">+/- {{getSortIcon('change')}}</th>
            <th (click)="sortBy('changePercent')" class="sortable text-right">% {{getSortIcon('changePercent')}}</th>
            <th (click)="sortBy('volume')" class="sortable text-right">KL {{getSortIcon('volume')}}</th>
            <th (click)="sortBy('contributionToIndex')" class="sortable text-right">ƒê√≥ng g√≥p {{getSortIcon('contributionToIndex')}}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let stock of filteredStocks" class="stock-row">
            <td class="symbol">{{stock.symbol}}</td>
            <td class="name">{{stock.name}}</td>
            <td class="price text-right" [class]="getPriceChangeClass(stock.change)">
              {{formatPrice(stock.price)}}
            </td>
            <td class="change text-right" [class]="getPriceChangeClass(stock.change)">
              {{stock.change > 0 ? '+' : ''}}{{formatPrice(stock.change)}}
            </td>
            <td class="change-percent text-right" [class]="getPriceChangeClass(stock.change)">
              {{formatPercent(stock.changePercent)}}
            </td>
            <td class="volume text-right">{{formatNumber(stock.volume)}}</td>
            <td class="contribution text-right">{{stock.contributionToIndex || 0}}</td>
          </tr>
          <tr *ngIf="filteredStocks.length === 0" class="no-results">
            <td colspan="7">
              <div class="no-results-content">
                <p>üìä Kh√¥ng t√¨m th·∫•y c·ªï phi·∫øu n√†o</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Top Movers View -->
    <div *ngIf="activeMarketView === 'topMovers'">
      <div class="sub-header">
        <div class="mover-type-selector">
          <button 
            *ngFor="let type of moverTypes"
            class="mover-type-btn"
            [class.active]="selectedMoverType === type.code"
            (click)="changeMoverType(type.code)"
          >
            <span class="type-icon">{{type.icon}}</span>
            <span class="type-name">{{type.name}}</span>
          </button>
        </div>
        <div class="search-box">
          <input
            type="text"
            [(ngModel)]="searchTerm"
            (input)="filterStocks()"
            placeholder="T√¨m ki·∫øm m√£ CP..."
            class="search-input"
          />
        </div>
      </div>

      <div class="info-bar" *ngIf="lastUpdate">
        <span class="info-item">‚ö° {{getMoverTypeName()}}</span>
        <span class="info-item">‚è∞ {{lastUpdate | date:'HH:mm:ss dd/MM/yyyy'}}</span>
        <span class="info-item">üìà {{filteredTopMovers.length}} c·ªï phi·∫øu</span>
      </div>

      <div class="table-container">
        <table class="stock-table">
          <thead>
            <tr>
              <th>M√£ CP</th>
              <th>T√™n c√¥ng ty</th>
              <th class="text-right">Gi√°</th>
              <th class="text-right">+/-</th>
              <th class="text-right">%</th>
              <th class="text-right">KL</th>
              <th class="text-right">Cao</th>
              <th class="text-right">Th·∫•p</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let mover of filteredTopMovers" class="stock-row">
              <td class="symbol clickable" (click)="viewStockDetail(mover.symbol)">{{mover.symbol}}</td>
              <td class="name">{{mover.name}}</td>
              <td class="price text-right" [class]="getPriceChangeClass(mover.change)">
                {{formatPrice(mover.price)}}
              </td>
              <td class="change text-right" [class]="getPriceChangeClass(mover.change)">
                {{mover.change > 0 ? '+' : ''}}{{formatPrice(mover.change)}}
              </td>
              <td class="change-percent text-right" [class]="getPriceChangeClass(mover.change)">
                {{formatPercent(mover.changePercent)}}
              </td>
              <td class="volume text-right">{{formatNumber(mover.volume)}}</td>
              <td class="high text-right">{{formatPrice(mover.high)}}</td>
              <td class="low text-right">{{formatPrice(mover.low)}}</td>
            </tr>
            <tr *ngIf="filteredTopMovers.length === 0" class="no-results">
              <td colspan="8">
                <div class="no-results-content">
                  <p>üìä Kh√¥ng t√¨m th·∫•y c·ªï phi·∫øu n√†o</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- TAB 2: All Instruments (Danh s√°ch m√£ ch·ª©ng kho√°n) -->
  <div class="tab-content" *ngIf="activeTab === 'movers' && !loading">
    <div class="sub-header">
      <div class="exchange-selector">
        <button 
          *ngFor="let exchange of exchanges"
          class="exchange-btn"
          [class.active]="selectedExchange === exchange.code"
          (click)="changeExchange(exchange.code)"
        >
          {{exchange.name}}
        </button>
      </div>
      <div class="search-box">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="filterStocks()"
          placeholder="T√¨m ki·∫øm m√£ CP..."
          class="search-input"
        />
      </div>
    </div>

    <div class="info-bar" *ngIf="lastUpdate">
      <span class="info-item">üìä S√†n: <strong>{{getSelectedExchangeName()}}</strong></span>
      <span class="info-item">‚è∞ {{lastUpdate | date:'HH:mm:ss dd/MM/yyyy'}}</span>
      <span class="info-item">üìà {{filteredStocks.length}} / {{stocks.length}} c·ªï phi·∫øu</span>
    </div>

    <div class="table-container">
      <table class="stock-table">
        <thead>
          <tr>
            <th (click)="sortBy('symbol')" class="sortable">M√£ CP {{getSortIcon('symbol')}}</th>
            <th (click)="sortBy('name')" class="sortable">T√™n c√¥ng ty {{getSortIcon('name')}}</th>
            <th (click)="sortBy('price')" class="sortable text-right">Gi√° {{getSortIcon('price')}}</th>
            <th (click)="sortBy('change')" class="sortable text-right">+/- {{getSortIcon('change')}}</th>
            <th (click)="sortBy('changePercent')" class="sortable text-right">% {{getSortIcon('changePercent')}}</th>
            <th (click)="sortBy('volume')" class="sortable text-right">KL {{getSortIcon('volume')}}</th>
            <th (click)="sortBy('high')" class="sortable text-right">Cao {{getSortIcon('high')}}</th>
            <th (click)="sortBy('low')" class="sortable text-right">Th·∫•p {{getSortIcon('low')}}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let stock of filteredStocks" class="stock-row">
            <td class="symbol clickable" (click)="viewStockDetail(stock.symbol)">{{stock.symbol}}</td>
            <td class="name">{{stock.name}}</td>
            <td class="price text-right" [class]="getPriceChangeClass(stock.change)">
              {{formatPrice(stock.price)}}
            </td>
            <td class="change text-right" [class]="getPriceChangeClass(stock.change)">
              {{stock.change > 0 ? '+' : ''}}{{formatPrice(stock.change)}}
            </td>
            <td class="change-percent text-right" [class]="getPriceChangeClass(stock.change)">
              {{formatPercent(stock.changePercent)}}
            </td>
            <td class="volume text-right">{{formatNumber(stock.volume)}}</td>
            <td class="high text-right">{{formatPrice(stock.high)}}</td>
            <td class="low text-right">{{formatPrice(stock.low)}}</td>
          </tr>
          <tr *ngIf="filteredStocks.length === 0" class="no-results">
            <td colspan="8">
              <div class="no-results-content">
                <p>üìä Kh√¥ng t√¨m th·∫•y c·ªï phi·∫øu n√†o</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- TAB 3: Industries -->
  <div class="tab-content industries-tab" *ngIf="activeTab === 'industries' && !loading">
    <div class="industries-layout">
      <!-- Industry List -->
      <div class="industry-list">
        <div class="search-box">
          <input
            type="text"
            [(ngModel)]="industrySearchTerm"
            (input)="filterIndustries()"
            placeholder="T√¨m ki·∫øm ng√†nh..."
            class="search-input"
          />
        </div>
        <div class="industry-items">
          <button 
            *ngFor="let industry of filteredIndustries; trackBy: trackByIndustryCode"
            class="industry-item"
            [ngClass]="{'active': isIndustrySelected(industry)}"
            (click)="selectIndustry(industry)"
            type="button"
          >
            <span class="industry-code">{{industry.icbCode}}</span>
            <span class="industry-name">{{industry.icbName}}</span>
          </button>
          <div *ngIf="filteredIndustries.length === 0" class="no-results-content">
            <p>üè¢ Kh√¥ng t√¨m th·∫•y ng√†nh n√†o</p>
          </div>
        </div>
      </div>

      <!-- Stocks in Industry -->
      <div class="industry-stocks">
        <div *ngIf="!selectedIndustry" class="placeholder">
          <p>üëà Ch·ªçn m·ªôt ng√†nh ƒë·ªÉ xem danh s√°ch c·ªï phi·∫øu</p>
        </div>
        <div *ngIf="selectedIndustry">
          <h3>{{selectedIndustry.icbName}} ({{filteredStocks.length}} c·ªï phi·∫øu)</h3>
          <div class="table-container">
            <table class="stock-table compact">
              <thead>
                <tr>
                  <th>M√£ CP</th>
                  <th>T√™n</th>
                  <th class="text-right">Gi√°</th>
                  <th class="text-right">%</th>
                  <th class="text-right">KL</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let stock of filteredStocks; trackBy: trackByStockSymbol" class="stock-row">
                  <td class="symbol clickable" (click)="viewStockDetail(stock.symbol)">{{stock.symbol}}</td>
                  <td class="name">{{stock.name}}</td>
                  <td class="price text-right" [class]="getPriceChangeClass(stock.change)">
                    {{formatPrice(stock.price)}}
                  </td>
                  <td class="change-percent text-right" [class]="getPriceChangeClass(stock.change)">
                    {{formatPercent(stock.changePercent)}}
                  </td>
                  <td class="volume text-right">{{formatNumber(stock.volume)}}</td>
                </tr>
                <tr *ngIf="filteredStocks.length === 0" class="no-results">
                  <td colspan="5">
                    <div class="no-results-content">
                      <p>Kh√¥ng c√≥ c·ªï phi·∫øu trong ng√†nh n√†y</p>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TAB 4: Fundamentals - Enhanced -->
  <div class="tab-content fundamentals-tab" *ngIf="activeTab === 'fundamentals' && !loading">
    <div class="fundamental-search">
      <div class="search-box-large">
        <input
          type="text"
          [(ngModel)]="fundamentalSymbol"
          (keyup.enter)="searchFundamental()"
          placeholder="Nh·∫≠p m√£ c·ªï phi·∫øu (VD: VNM, FPT, HPG...)"
          class="search-input-large"
        />
        <button class="btn-search" (click)="searchFundamental()" [disabled]="fundamentalLoading">
          üîç Tra C·ª©u ƒê·∫ßy ƒê·ªß
        </button>
      </div>
    </div>

    <div *ngIf="fundamentalLoading" class="loading-small">
      <div class="spinner-small"></div>
      <p>ƒêang t·∫£i th√¥ng tin to√†n di·ªán...</p>
    </div>

    <!-- Comprehensive Data Display -->
    <div *ngIf="(symbolInfo || fundamentalData) && !fundamentalLoading" class="comprehensive-data">
      
      <!-- Symbol Overview -->
      <div class="data-section overview-section" *ngIf="symbolInfo">
        <div class="section-header">
          <h3>üìä {{symbolInfo.symbol}} - {{symbolInfo.organName || symbolInfo.organShortName}}</h3>
          <span class="badge">{{symbolInfo.exchange}}</span>
        </div>
        
        <div class="overview-cards">
          <div class="overview-card price-card">
            <div class="card-label">Gi√° hi·ªán t·∫°i</div>
            <div class="card-value large" [class]="getPriceChangeClass(symbolInfo.priceChange || 0)">
              {{formatPrice(symbolInfo.lastPrice || 0)}}
            </div>
            <div class="card-change" [class]="getPriceChangeClass(symbolInfo.priceChange || 0)">
              {{formatPrice(symbolInfo.priceChange || 0)}} ({{formatPercent(symbolInfo.perPriceChange || 0)}})
            </div>
          </div>
          
          <div class="overview-card">
            <div class="card-label">Kh·ªëi l∆∞·ª£ng</div>
            <div class="card-value">{{formatNumber(symbolInfo.totalVolume || 0)}}</div>
          </div>
          
          <div class="overview-card">
            <div class="card-label">Ng√†nh</div>
            <div class="card-value small">{{symbolInfo.icbName || 'N/A'}}</div>
          </div>
        </div>
      </div>

      <!-- Fundamentals -->
      <div class="data-section" *ngIf="fundamentalData">
        <div class="section-header">
          <h4>üí∞ Ch·ªâ S·ªë T√†i Ch√≠nh</h4>
        </div>
        <div class="fundamental-grid">
          <div class="fundamental-card">
            <div class="card-label">V·ªën h√≥a TT</div>
            <div class="card-value">{{formatMarketCap(fundamentalData.marketCap || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">CP l∆∞u h√†nh</div>
            <div class="card-value">{{formatNumber(fundamentalData.sharesOutstanding || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">EPS</div>
            <div class="card-value">{{formatRatio(fundamentalData.eps || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">P/E</div>
            <div class="card-value">{{formatRatio(fundamentalData.pe || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">P/B</div>
            <div class="card-value">{{formatRatio(fundamentalData.pb || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">ROE (%)</div>
            <div class="card-value">{{formatRatio(fundamentalData.roe || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">ROA (%)</div>
            <div class="card-value">{{formatRatio(fundamentalData.roa || 0)}}</div>
          </div>
          <div class="fundamental-card">
            <div class="card-label">S√†n GD</div>
            <div class="card-value">{{fundamentalData.exchange || 'N/A'}}</div>
          </div>
        </div>
      </div>

      <!-- Institution Profile -->
      <div class="data-section profile-section" *ngIf="institutionProfile">
        <div class="section-header">
          <h4>üè¢ H·ªì S∆° Doanh Nghi·ªáp</h4>
          <span class="badge" *ngIf="institutionProfile.isListed">ƒê√£ ni√™m y·∫øt</span>
        </div>
        
        <!-- Company Overview -->
        <div class="profile-overview" *ngIf="institutionProfile.overview">
          <h5>T·ªïng Quan</h5>
          <div class="overview-text" [innerHTML]="textToHtml(institutionProfile.overview)"></div>
        </div>

        <!-- Company History -->
        <div class="profile-overview" *ngIf="institutionProfile.history">
          <h5>L·ªãch S·ª≠ H√¨nh Th√†nh</h5>
          <div class="overview-text" [innerHTML]="textToHtml(institutionProfile.history)"></div>
        </div>

        <!-- Basic Info Grid -->
        <div class="profile-grid">
          <div class="profile-card" *ngIf="institutionProfile.companyName">
            <div class="card-label">T√™n c√¥ng ty</div>
            <div class="card-value">{{institutionProfile.companyName}}</div>
          </div>
          
          <div class="profile-card" *ngIf="institutionProfile.shortName">
            <div class="card-label">T√™n vi·∫øt t·∫Øt</div>
            <div class="card-value">{{institutionProfile.shortName}}</div>
          </div>
          
          <div class="profile-card" *ngIf="institutionProfile.exchange">
            <div class="card-label">S√†n giao d·ªãch</div>
            <div class="card-value">{{institutionProfile.exchange}}</div>
          </div>
          
          <div class="profile-card" *ngIf="institutionProfile.employees">
            <div class="card-label">S·ªë nh√¢n vi√™n</div>
            <div class="card-value">{{formatNumber(institutionProfile.employees)}}</div>
          </div>
          
          <div class="profile-card" *ngIf="institutionProfile.branches">
            <div class="card-label">Chi nh√°nh</div>
            <div class="card-value">{{institutionProfile.branches}}</div>
          </div>
          
          <div class="profile-card" *ngIf="institutionProfile.charterCapital">
            <div class="card-label">V·ªën ƒëi·ªÅu l·ªá</div>
            <div class="card-value">{{formatMarketCap(institutionProfile.charterCapital)}}</div>
          </div>
        </div>

        <!-- Contact Info -->
        <div class="contact-section">
          <h5>Th√¥ng Tin Li√™n H·ªá</h5>
          <div class="institution-details">
            <div class="detail-row" *ngIf="institutionProfile.headQuarters">
              <span class="detail-label">Tr·ª• s·ªü ch√≠nh:</span>
              <span class="detail-value">{{institutionProfile.headQuarters}}</span>
            </div>
            <div class="detail-row" *ngIf="institutionProfile.phone">
              <span class="detail-label">ƒêi·ªán tho·∫°i:</span>
              <span class="detail-value">{{institutionProfile.phone}}</span>
            </div>
            <div class="detail-row" *ngIf="institutionProfile.fax">
              <span class="detail-label">Fax:</span>
              <span class="detail-value">{{institutionProfile.fax}}</span>
            </div>
            <div class="detail-row" *ngIf="institutionProfile.email">
              <span class="detail-label">Email:</span>
              <span class="detail-value">{{institutionProfile.email}}</span>
            </div>
            <div class="detail-row" *ngIf="institutionProfile.webAddress">
              <span class="detail-label">Website:</span>
              <span class="detail-value"><a [href]="institutionProfile.webAddress" target="_blank">{{institutionProfile.webAddress}}</a></span>
            </div>
          </div>
        </div>

        <!-- Ownership -->
        <div class="ownership-section" *ngIf="institutionProfile.stateOwnership || institutionProfile.foreignOwnership">
          <h5>C∆° C·∫•u S·ªü H·ªØu</h5>
          <div class="ownership-bars">
            <div class="ownership-bar" *ngIf="institutionProfile.stateOwnership">
              <div class="bar-label">S·ªü h·ªØu Nh√† n∆∞·ªõc</div>
              <div class="bar-container">
                <div class="bar-fill state" [style.width.%]="institutionProfile.stateOwnership"></div>
                <span class="bar-value">{{formatOwnership(institutionProfile.stateOwnership)}}%</span>
              </div>
            </div>
            <div class="ownership-bar" *ngIf="institutionProfile.foreignOwnership">
              <div class="bar-label">S·ªü h·ªØu n∆∞·ªõc ngo√†i</div>
              <div class="bar-container">
                <div class="bar-fill foreign" [style.width.%]="institutionProfile.foreignOwnership"></div>
                <span class="bar-value">{{formatOwnership(institutionProfile.foreignOwnership)}}%</span>
              </div>
            </div>
            <div class="ownership-bar" *ngIf="institutionProfile.otherOwnership">
              <div class="bar-label">S·ªü h·ªØu kh√°c</div>
              <div class="bar-container">
                <div class="bar-fill other" [style.width.%]="institutionProfile.otherOwnership"></div>
                <span class="bar-value">{{formatOwnership(institutionProfile.otherOwnership)}}%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Historical Quotes -->
      <div class="data-section" *ngIf="historicalQuotes.length > 0">
        <div class="section-header">
          <h4>üìà L·ªãch S·ª≠ Gi√° ({{historicalDays}} ng√†y g·∫ßn nh·∫•t)</h4>
        </div>
        <div class="historical-table-container">
          <table class="historical-table">
            <thead>
              <tr>
                <th>Ng√†y</th>
                <th class="text-right">M·ªü c·ª≠a</th>
                <th class="text-right">Cao nh·∫•t</th>
                <th class="text-right">Th·∫•p nh·∫•t</th>
                <th class="text-right">ƒê√≥ng c·ª≠a</th>
                <th class="text-right">KL</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let quote of historicalQuotes.slice(0, 10)">
                <td>{{formatHistoricalDate(quote.date || '')}}</td>
                <td class="text-right">{{formatPrice(quote.open || 0)}}</td>
                <td class="text-right">{{formatPrice(quote.high || 0)}}</td>
                <td class="text-right">{{formatPrice(quote.low || 0)}}</td>
                <td class="text-right">{{formatPrice(quote.close || 0)}}</td>
                <td class="text-right">{{formatNumber(quote.volume || 0)}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- News/Posts -->
      <div class="data-section posts-section" *ngIf="symbolPosts.length > 0">
        <div class="section-header">
          <h4>üì∞ Tin T·ª©c & Th·∫£o Lu·∫≠n</h4>
          <span class="post-count">{{symbolPosts.length}} b√†i vi·∫øt</span>
        </div>
        <div class="posts-list">
          <div class="post-card" *ngFor="let post of symbolPosts">
            <!-- User Info -->
            <div class="post-header" *ngIf="post.user">
              <div class="user-avatar">
                {{post.user.name?.charAt(0) || '?'}}
              </div>
              <div class="user-info">
                <div class="user-name">
                  {{post.user.name}}
                  <span class="verified-badge" *ngIf="post.user.isAuthentic">‚úì</span>
                </div>
                <div class="post-date">{{formatPostDate(post.publishDate || post.date)}}</div>
              </div>
            </div>

            <!-- Post Content -->
            <div class="post-body">
              <h5 class="post-title" *ngIf="post.title">{{decodeHtml(post.title)}}</h5>
              <div class="post-content-text" [innerHTML]="decodeHtml(post.content || post.originalContent || '')"></div>
              
              <!-- Link Preview -->
              <div class="link-preview" *ngIf="post.link">
                <img *ngIf="post.linkImage" [src]="post.linkImage" [alt]="post.linkTitle" class="link-image">
                <div class="link-info">
                  <div class="link-title" *ngIf="post.linkTitle">{{post.linkTitle}}</div>
                  <div class="link-desc" *ngIf="post.linkDescription">{{post.linkDescription}}</div>
                  <a [href]="post.link" target="_blank" class="link-url">{{post.link}}</a>
                </div>
              </div>

              <!-- Images -->
              <div class="post-images" *ngIf="post.images && post.images.length > 0">
                <img *ngFor="let img of post.images" [src]="img.imageUrl" alt="Post image" class="post-image">
              </div>
            </div>

            <!-- Post Footer -->
            <div class="post-footer">
              <div class="post-stats">
                <span class="stat-item" *ngIf="post.totalLikes">
                  <span class="stat-icon">üëç</span>
                  <span class="stat-value">{{post.totalLikes}}</span>
                </span>
                <span class="stat-item" *ngIf="post.totalReplies">
                  <span class="stat-icon">üí¨</span>
                  <span class="stat-value">{{post.totalReplies}}</span>
                </span>
                <span class="stat-item" *ngIf="post.totalShares">
                  <span class="stat-icon">üîÑ</span>
                  <span class="stat-value">{{post.totalShares}}</span>
                </span>
              </div>
              
              <!-- Tagged Symbols -->
              <div class="tagged-symbols" *ngIf="post.taggedSymbols && post.taggedSymbols.length > 0">
                <span class="tag-label">C·ªï phi·∫øu:</span>
                <span class="symbol-tag" *ngFor="let tagged of post.taggedSymbols">
                  {{tagged.symbol}}
                  <span [class]="getChangeClass(tagged.change)">
                    {{formatChange(tagged.change)}}
                  </span>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- No Data Placeholder -->
    <div *ngIf="!symbolInfo && !fundamentalData && !fundamentalLoading" class="placeholder-large">
      <div class="placeholder-icon">üîç</div>
      <p class="placeholder-text">
        Nh·∫≠p m√£ c·ªï phi·∫øu ƒë·ªÉ xem:<br>
        ‚Ä¢ Th√¥ng tin gi√° & giao d·ªãch<br>
        ‚Ä¢ Ch·ªâ s·ªë t√†i ch√≠nh<br>
        ‚Ä¢ L·ªãch s·ª≠ gi√°<br>
        ‚Ä¢ Tin t·ª©c & b√†i vi·∫øt<br>
        ‚Ä¢ H·ªì s∆° doanh nghi·ªáp
      </p>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p class="disclaimer">
      ‚ö†Ô∏è D·ªØ li·ªáu ch·ªâ mang t√≠nh ch·∫•t tham kh·∫£o. 
      Ngu·ªìn: <a href="https://fireant.vn" target="_blank">FireAnt.vn</a>
    </p>
  </div>
</div>
